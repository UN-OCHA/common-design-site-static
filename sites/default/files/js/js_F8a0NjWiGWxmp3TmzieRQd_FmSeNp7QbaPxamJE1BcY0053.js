/* @license GPL-2.0-or-later https://www.drupal.org/licensing/faq */
(function(Drupal){'use strict';Drupal.behaviors.cdDropdown={idPrefix:'cd-dropdown-toggable-',idMax:0,attach:function(context,settings){this.handleClickAway=this.handleClickAway.bind(this);this.handleEscape=this.handleEscape.bind(this);this.handleResize=this.handleResize.bind(this);this.handleToggle=this.handleToggle.bind(this);this.initializeTogglables();this.updateDrupalTogglableMenus();},getTogglerElement:function(element){var id=this.getTogglableId(element);return document.querySelector('[data-cd-toggler][aria-controls="'+id+'"]');},getTogglableElement:function(toggler){return document.getElementById(toggler.getAttribute('aria-controls'));},getTogglableId:function(element){if(!element.hasAttribute('id')){this.idMax++;element.id=this.idPrefix+this.idMax;}return element.id;},toggle:function(toggler,collapse){var element=this.getTogglableElement(toggler);if(element){var expanded=collapse||toggler.getAttribute('aria-expanded')==='true';toggler.setAttribute('aria-expanded',!expanded);element.setAttribute('data-cd-hidden',expanded);var labelWrapper=toggler.querySelector('[data-cd-label-switch]');if(labelWrapper){var label=labelWrapper.getAttribute('data-cd-label-switch');labelWrapper.setAttribute('data-cd-label-switch',labelWrapper.textContent);labelWrapper.textContent=label;}if(element.hasAttribute('data-cd-focus-target')&&!expanded){var target=document.getElementById(element.getAttribute('data-cd-focus-target'));if(target)target.focus();}}},collapseAll:function(exceptions){var elements=document.querySelectorAll('[data-cd-toggler][aria-expanded="true"]');exceptions=exceptions||[];var cdDropdown=this;elements.forEach(function(element){if(!element.hasAttribute('data-cd-toggable-keep')&&exceptions.indexOf(element)===-1)cdDropdown.toggle(element,true);});},getTogglableParents:function(element){var elements=[];while(element&&element!==document){if(element.hasAttribute&&element.hasAttribute('data-cd-toggable'))element=element.previousElementSibling;if(!element)break;if(element.hasAttribute&&element.hasAttribute('data-cd-toggler'))elements.push(element);element=element.parentNode;}return elements;},handleToggle:function(event){var target=event.currentTarget;if(target){this.collapseAll(this.getTogglableParents(target));this.toggle(target);}event.preventDefault();event.stopPropagation();},handleEscape:function(event){var key=event.which||event.keyCode;if(key===27){var target=event.currentTarget;if(!target.hasAttribute('data-cd-toggler'))target=this.getTogglerElement(target);if(target&&target.hasAttribute('data-cd-toggler')){target.focus();this.toggle(target,true);}}},handleClickAway:function(event){var target=event.target;if(target){if(target.nodeName==='A'&&!target.hasAttribute('data-cd-toggler'))this.collapseAll();else while(target&&target!==document){if(target.hasAttribute)if(target.hasAttribute('data-cd-toggler')||target.hasAttribute('data-cd-toggable'))return;target=target.parentNode;}this.collapseAll();}},handleResize:function(selector){var elements=document.querySelectorAll('[data-cd-toggable]');for(var i=0,l=elements.length;i<l;i++)this.updateTogglable(elements[i]);},createIcon:function(name,component,type){var svgElem=document.createElementNS('http://www.w3.org/2000/svg','svg');var useElem=document.createElementNS('http://www.w3.org/2000/svg','use');useElem.setAttributeNS('http://www.w3.org/1999/xlink','xlink:href','#cd-icon--'+name);svgElem.setAttribute('width','16');svgElem.setAttribute('height','16');svgElem.setAttribute('aria-hidden','true');svgElem.setAttribute('focusable','false');var classes=['cd-icon','cd-icon--'+name];if(component&&type)classes.push(component+'__'+type);svgElem.setAttribute('class',classes.join(' '));svgElem.appendChild(useElem);return svgElem;},createButton:function(element){var id=this.getTogglableId(element);var label=element.getAttribute('data-cd-toggable');var logo=element.getAttribute('data-cd-logo');var logoOnly=element.hasAttribute('data-cd-logo-only');var icon=element.getAttribute('data-cd-icon');var component=element.getAttribute('data-cd-component');var button=document.createElement('button');button.setAttribute('type','button');button.setAttribute('id',id+'-toggler');if(logo)button.appendChild(this.createIcon(logo,component,'logo'));var labelWrapper=document.createElement('span');labelWrapper.appendChild(document.createTextNode(label));button.appendChild(labelWrapper);if(logo&&logoOnly)labelWrapper.classList.add('visually-hidden');if(icon)button.appendChild(this.createIcon(icon,component,'icon'));if(component){button.classList.add(component+'__btn');labelWrapper.classList.add(component+'__btn-label');}if(element.hasAttribute('data-cd-toggable-keep'))button.setAttribute('data-cd-toggable-keep','');if(element.hasAttribute('data-cd-toggable-expanded'))labelWrapper.setAttribute('data-cd-label-switch',element.getAttribute('data-cd-toggable-expanded'));return button;},setTogglable:function(element){var toggler=this.getTogglerElement(element)||element.previousElementSibling;if(toggler)if(toggler.nodeName!=='BUTTON'){if(!element.hasAttribute('data-cd-replace'))return;}else{if(toggler.hasAttribute('data-cd-toggler'))return;}if(!toggler||element.hasAttribute('data-cd-replace'))toggler=this.createButton(element);var expand=element.hasAttribute('data-cd-toggable-expand')||false;toggler.setAttribute('data-cd-toggler','');toggler.setAttribute('aria-expanded',expand!==false);toggler.setAttribute('aria-haspopup','menu');toggler.setAttribute('aria-controls',this.getTogglableId(element));toggler.addEventListener('click',this.handleToggle);toggler.addEventListener('keydown',this.handleEscape);element.addEventListener('keydown',this.handleEscape);element.addEventListener('focusout',(ev)=>{if(ev.relatedTarget&&!element.contains(ev.relatedTarget)&&toggler!==ev.relatedTarget)this.toggle(toggler,true);});toggler.addEventListener('focusout',(ev)=>{if(ev.relatedTarget&&!element.contains(ev.relatedTarget)&&element!==ev.relatedTarget)this.toggle(toggler,true);});if(!element.hasAttribute('data-cd-toggable'))element.setAttribute('data-cd-toggable','');element.setAttribute('data-cd-hidden',expand===false);if(element.hasAttribute('data-cd-replace')){var fallback=document.getElementById(element.getAttribute('data-cd-replace'));if(fallback)fallback.parentNode.removeChild(fallback);element.removeAttribute('data-cd-replace');}if(element.previousElementSibling!==toggler)element.parentNode.insertBefore(toggler,element);},unsetTogglable:function(element){var toggler=this.getTogglerElement(element);if(toggler&&toggler.hasAttribute('data-cd-toggler')){toggler.addEventListener('click',this.handleToggle);toggler.addEventListener('keydown',this.handleEscape);element.addEventListener('keydown',this.handleEscape);toggler.parentNode.removeChild(toggler);element.removeEventListener('keydown',this.handleEscape);element.removeAttribute('data-cd-hidden');}},updateTogglable:function(element){if(window.getComputedStyle(element,null).getPropertyValue('--dropdown').trim()==='false')this.unsetTogglable(element);else this.setTogglable(element);if(!element.hasAttribute('data-cd-processed'))element.setAttribute('data-cd-processed',true);},initializeTogglables:function(){var toggables=document.querySelectorAll('[data-cd-toggable]');for(var i=0,l=toggables.length;i<l;i++){var toggable=toggables[i];if(toggable.hasAttribute('id')&&toggable.id.indexOf(this.idPrefix)===0){var id=parseInt(toggable.id.slice(this.idPrefix.length-1),10);if(id>this.idMax)this.idMax=id;}}document.addEventListener('click',this.handleClickAway);window.addEventListener('resize',this.handleResize);this.handleResize();},updateDrupalTogglableMenus:function(selector){selector=typeof selector!=='undefined'?selector:'.cd-nav .menu a + .menu';var elements=document.querySelectorAll(selector);for(var i=0,l=elements.length;i<l;i++)this.setTogglable(elements[i]);}};})(Drupal);;
(function(Drupal){'use strict';Drupal.behaviors.cdUserMenu={attach:function(context,settings){Drupal.behaviors.cdDropdown.updateDrupalTogglableMenus('.cd-global-header__user-menu .menu button + .menu');}};})(Drupal);;
